<!DOCTYPE html>

<html class="dark" lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
  <title>Web3 Wallet Login Page</title>
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <link href="https://fonts.googleapis.com" rel="preconnect" />
  <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&amp;display=swap"
    rel="stylesheet" />
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
    rel="stylesheet" />
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
    rel="stylesheet" />
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#4A44F2",
            "background-light": "#f6f6f8",
            "background-dark": "#12121A",
          },
          fontFamily: {
            "display": ["Space Grotesk", "sans-serif"]
          },
          borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px" },
        },
      },
    }
  </script>
  <style>
    .material-symbols-outlined {
      font-variation-settings:
        'FILL' 0,
        'wght' 400,
        'GRAD' 0,
        'opsz' 24
    }
  </style>
</head>

<body class="font-display">
  <div
    class="relative flex min-h-screen w-full flex-col items-center justify-center bg-background-light dark:bg-background-dark p-4 sm:p-6 lg:p-8">
    <div class="w-full max-w-md">
      <header class="mb-8 flex flex-col items-center text-center">
        <div class="flex items-center justify-center mb-4">
          <span class="material-symbols-outlined text-primary text-4xl">account_balance_wallet</span>
        </div>
        <h1 class="text-3xl font-bold text-gray-900 dark:text-white">Welcome Back</h1>
        <p class="mt-2 text-base text-gray-600 dark:text-gray-400">Securely access your Web3 wallet</p>
      </header>
      <main class="w-full space-y-6">
        <form id="loginForm" class="space-y-4">
          <label class="flex flex-col">
            <p class="pb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Email</p>
            <div class="flex w-full flex-1 items-stretch rounded-lg">
              <input id="email"
                class="form-input h-12 flex-1 resize-none overflow-hidden rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 p-3 text-gray-900 dark:text-white placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:border-primary focus:outline-0 focus:ring-2 focus:ring-primary/30"
                placeholder="your@email.com" type="email" required />
            </div>
          </label>
          <label class="flex flex-col">
            <p class="pb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Password</p>
            <div class="flex w-full flex-1 items-stretch rounded-lg">
              <input id="passwordInput"
                class="form-input h-12 flex-1 resize-none overflow-hidden rounded-l-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 p-3 text-gray-900 dark:text-white placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:border-primary focus:outline-0 focus:ring-2 focus:ring-primary/30 rounded-r-none border-r-0"
                placeholder="••••••••" type="password" required />
              <button id="togglePasswordBtn"
                class="flex items-center justify-center rounded-r-lg border border-l-0 border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 px-3 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors"
                type="button" onclick="togglePasswordVisibility()">
                <span class="material-symbols-outlined" id="passwordIcon">visibility</span>
              </button>
            </div>
          </label>
          <div class="text-right">
            <a class="text-sm text-primary hover:underline" href="/forgot_password">Forgot Password?</a>
          </div>
          <button id="loginBtn"
            class="flex h-12 w-full cursor-pointer items-center justify-center overflow-hidden rounded-lg bg-primary px-5 text-base font-bold text-white shadow-sm transition-colors hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 dark:focus:ring-offset-background-dark"
            type="button" onclick="submitLogin()">
            <span class="truncate">Log In</span>
          </button>
        </form>
        <div class="flex items-center">
          <hr class="w-full border-gray-300 dark:border-gray-700" />
          <span class="px-2 text-sm text-gray-500 dark:text-gray-400">OR</span>
          <hr class="w-full border-gray-300 dark:border-gray-700" />
        </div>
        <button
          class="flex h-12 w-full cursor-pointer items-center justify-center gap-3 overflow-hidden rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 px-5 text-base font-medium text-gray-800 dark:text-white shadow-sm transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 dark:focus:ring-offset-background-dark"
          type="button" onclick="window.location.href='/login/google'">
          <svg class="h-5 w-5" fill="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M22.56 12.25C22.56 11.45 22.49 10.68 22.36 9.92H12V14.48H18.18C17.91 16.03 17.06 17.34 15.65 18.29V21.09H19.5C21.46 19.29 22.56 16.1 22.56 12.25Z"
              fill="#4285F4"></path>
            <path
              d="M12 23C14.97 23 17.45 22.04 19.5 20.48L15.65 17.68C14.67 18.33 13.43 18.75 12 18.75C9.13 18.75 6.67 16.89 5.82 14.31H1.9V17.1C3.86 20.69 7.64 23 12 23Z"
              fill="#34A853"></path>
            <path
              d="M5.82 14.31C5.56 13.58 5.41 12.8 5.41 12C5.41 11.2 5.56 10.42 5.82 9.69V6.9H1.9C1.19 8.36 0.75 10.12 0.75 12C0.75 13.88 1.19 15.64 1.9 17.1L5.82 14.31Z"
              fill="#FBBC05"></path>
            <path
              d="M12 5.25C13.53 5.25 14.92 5.79 16.05 6.85L19.58 3.32C17.45 1.48 14.97 0.5 12 0.5C7.64 0.5 3.86 2.81 1.9 6.4L5.82 9.19C6.67 6.61 9.13 4.75 12 4.75L12 5.25Z"
              fill="#EA4335"></path>
          </svg>
          <span class="truncate">Continue with Google</span>
        </button>
      </main>
      <footer class="mt-8 text-center">
        <p class="text-sm text-gray-600 dark:text-gray-400">
          Don't have an account? <a class="font-medium text-primary hover:underline" href="/register">Sign Up</a>
        </p>
      </footer>
    </div>
  </div>

  <script>
    function togglePasswordVisibility() {
      const passwordInput = document.getElementById('passwordInput');
      const passwordIcon = document.getElementById('passwordIcon');

      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        passwordIcon.textContent = 'visibility_off';
      } else {
        passwordInput.type = 'password';
        passwordIcon.textContent = 'visibility';
      }
    }

    async function submitLogin() {
      const email = document.getElementById('email').value;
      const password = document.getElementById('passwordInput').value;
      const loginBtn = document.getElementById('loginBtn');
      const originalBtnContent = loginBtn.innerHTML;

      if (!email || !password) {
        alert('Please enter both email and password');
        return;
      }

      // Set loading state
      loginBtn.disabled = true;
      loginBtn.innerHTML = `
        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        Processing...
      `;

      try {
        const response = await fetch('/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            email: email,
            password: password
          })
        });

        const data = await response.json();

        if (data.status === 'success') {
          // Redirect to dashboard on successful login
          window.location.href = '/dashboard';
        } else {
          // Reset button state on API error
          alert('Error: ' + data.message);
          loginBtn.disabled = false;
          loginBtn.innerHTML = originalBtnContent;
        }
      } catch (error) {
        // Reset button state on network error
        alert('Login error: ' + error.message);
        loginBtn.disabled = false;
        loginBtn.innerHTML = originalBtnContent;
      }
    }
  </script>
</body>

</html>